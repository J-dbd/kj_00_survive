<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>정글에서 살아남기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.8.1/flowbite.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.8.1/flowbite.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script type="text/javascript"></script>
    <script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>

</head>

<body>
    <div class="flex items-center justify-center h-screen bg-black">
        <div class="flex flex-col items-center justify-center bg-white w-[420px] h-[300px]">
            <div>
                <h1 class="flex items-center text-3xl font-extrabold dark:text-white">회원가입 완료</h1>
            </div>
            <div class="mt-10 sm:mx-auto sm:w-full sm:max-w-sm" style="text-align:center">
                <strong class="font-bold green">김철수</strong>님의 <strong class="font-bold green">생존</strong>이 시작됩니다
                <div style="text-align: center; margin-top:20px"> <button type="button"
                        class="flex w-full justify-center rounded-md bg-green-600 px-1 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-green-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600"
                        style="display: block;" onclick="window.location.href=`{{ url_for('login') }}`">
                        로그인 페이지 이동
                    </button></div>
            </div>

        </div>
    </div>
</body>
<script>
    $("#confirm_password").on("keyup", function () {
        let pwd = $('#password').val()
        let pwd2 = $('#confirm_password').val()
        if (pwd !== pwd2) {
            $("#validation").html("비밀번호가 일치하지 않습니다").show();
        }
        else {
            $("#validation").hide()
        }
    });

    function signIn() {
        const url = '/sign_in'

        const id = $('#id').val()
        const password = $('#password').val()
        const name = $('#name').val()
        const email = $('#email').val()
        let formData = { 'id': id, 'password': password, 'name': name, 'email': email }

        console.log("formData", formData)
        $.ajax({
            url: url,
            type: "POST",
            async: true,
            data: formData,
            error: function (request, status, error) {
                console.log("code: " + request.status)
                console.log("message: " + request.responseText)
                console.log("error: " + error);
            },
            success: function (res) {
                console.log("success")
                console.log("res", res)
                if (res['result'] == "success") {
                    localStorage.setItem('token', res.access_token);
                    alert("회원가입에 성공하였습니다.")
                    window.location.href = "{{ url_for('login') }}"
                }
                else {
                    $("#validation").html(res['reason']).show();
                }

            }

        })
    }
</script>

</html>